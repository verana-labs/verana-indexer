# Global configuration for the application
global: 
  domain: testnet.verana.network # Domain for the application

# General configuration
name: idx
replicas: 1 # Number of replicas for the Indexer service

# Ports
apiPort: 3001

# Resource limits for the main indexer container
# These limits help prevent MemoryPressure pod evictions
resources:
  requests:
    cpu: 250m
    memory: 512Mi
  limits:
    cpu: "2"
    memory: 4Gi

# Node.js memory settings (should be ~75% of memory limit)
nodeOptions: "--max-old-space-size=3072"

# DB and Redis configuration
database:
  enabled: true
  host: localhost
  user: verana_testnet1
  pwd: pass
  db: verana_testnet1
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

redis: 
  enabled: true
  host: localhost
  resources:
    requests:
      cpu: 25m
      memory: 64Mi
    limits:
      cpu: 100m
      memory: 128Mi

# Enable cors for the Indexer
ingress:
  host: "{{ .Values.name }}.{{ .Values.global.domain }}"
  tlsSecret: public.{{ .Values.name }}.{{ .Values.global.domain }}-cert
  public:
    enableCors: true
  private:
    enableCors: true
    whitelistSourceRange: "" # e.g. "xxx.xx.xxx.xxx/32"
    tlsSecret: "private.{{ .Values.name }}.{{ .Values.global.domain }}-cert"
    host: ""

# Extra environment variables (extensible)
extraEnv: []

# Persistent volume configuration for app
storage:
  size: 1Gi
  storageClassName: csi-cinder-high-speed
